@model JaguarWeb.Clients.AnalysisControlFlowModel


@{
    ViewData["Title"] = $"{Model.ProjectID}";
    ViewData["Breadcrumbs"] = new List<KeyValuePair<string,string>>(){
        new KeyValuePair<string, string>($"Home","Projects"),
        new KeyValuePair<string, string>($"Project/{Model.ProjectID}",Model.ProjectID),
        new KeyValuePair<string, string>($"Analyse/{Model.Id}",Model.CreatedDate.ToString("MM/dd/yyyy HH:mm"))
        }; 
}

<h1>Analyse</h1>
<h2>@ViewData["Title"] in @Model.CreatedDate.ToString("MM/dd/yyyy HH:mm")</h2>

<section class="executionConfigs">
    <p><em>Heuristic: </em>@Model.Heuristic</p>
    <p><em>Requirement Type: </em>LINE</p>
    <p><em>Tests: </em>
        @Model.FailedTests.ToString() failed out of @Model.TotalTests.ToString()
    </p>
</section>

<section class="testRequirements">
    <h3 class="subTitle">Line Color Susp</h3>

    <article class="tableControls">
        <p>
            Suspiciouness Filter:
            <input type="range" min="0.0" max="1.0" step="0.1" value="1.0" id="susRange" list="tickmarks">
            <datalist id="tickmarks">
                <option value="0.0"></option>
                <option value="0.1"></option>
                <option value="0.2"></option>
                <option value="0.3"></option>
                <option value="0.4"></option>
                <option value="0.5"></option>
                <option value="0.6"></option>
                <option value="0.7"></option>
                <option value="0.8"></option>
                <option value="0.9"></option>
                <option value="1.0"></option>
            </datalist>

            <span id="rangeText"></span>

        </p>
        <p>
            <label for="itensPerTable">Itens per table: </label>
            <select name="itensPerTable" id="itensPerTable">
                <option value="10" selected>10</option>
                <option value="20">20</option>
                <option value="30">30</option>
                <option value="40">40</option>
                <option value="all">All</option>
            </select>
        </p>
    </article>

    <article id="tableContainer">
        <table id="dataTable">
            <tr>
                <th>Class</th>
                <th>Bar</th>
                <th class="align-center" id="suspColumn"><abbr title="suspiciousness">Susp.</abbr> </th>
                <th class="align-center">
                    <abbr title="the number of failed test cases that executed the component">C.E.F</abbr>
                </th>
                <th class="align-center" >
                    <abbr title="the number of passed test cases that executed the component">C.E.P</abbr>
                </th>
                <th class="align-center" >
                    <abbr title="the number of failed test cases that did not execute the component">C.N.F</abbr>
                </th>
                <th class="align-center" >
                    <abbr title="the number of passed test cases that did not execute the component">C.N.P</abbr>
                </th>
            </tr>

        @foreach (var item in Model.Classes)
        {
            var line= item.Lines.FirstOrDefault(x=>x.SuspiciousValue == item.Lines.Max(x=>x.SuspiciousValue));
            <tr>
                <td><a href="~/Analyse/@Model.Id/@item.FullName">@item.FullName</a></td>
                <td><a href="~/Analyse/@Model.Id/@item.FullName"><div class="suspBar"><div class="redBar" style='grid-column-end: @Html.Raw(((line.SuspiciousValue*10)+1).ToString("n0"))'></div></div></a></td>
                <td><a class=" align-right" href="~/Analyse/@Model.Id/@item.FullName">@line.SuspiciousValue.ToString("0.00", System.Globalization.CultureInfo.InvariantCulture)</a></td>
                <td><a class=" align-right" href="~/Analyse/@Model.Id/@item.FullName">@line.Cef.ToString("0.00", System.Globalization.CultureInfo.InvariantCulture)</a></td>
                <td><a class=" align-right" href="~/Analyse/@Model.Id/@item.FullName">@line.Cep.ToString("0.00", System.Globalization.CultureInfo.InvariantCulture)</a></td>
                <td><a class=" align-right" href="~/Analyse/@Model.Id/@item.FullName">@line.Cnf.ToString("0.00", System.Globalization.CultureInfo.InvariantCulture)</a></td>
                <td><a class=" align-right" href="~/Analyse/@Model.Id/@item.FullName">@line.Cnp.ToString("0.00", System.Globalization.CultureInfo.InvariantCulture)</a></td>
            </tr>
        }

        </table>
    </article>
    <div id="pagination"></div>
</section>


@section Scripts{
    <script src="~/js/table-controls.js" async asp-append-version="true"></script>
}
